Техническое руководство: Текстовый редактор на Python (Tkinter)

1. Введение

Простой кроссплатформенный текстовый редактор с базовым функционалом:

Сохранение документов

Статистика слов/символов

Поиск с подсветкой

Смена шрифтов и тем

Горячие клавиши

2. Требования

Python 3.6+

Стандартные библиотеки:

tkinter

filedialog

simpledialog

3. Архитектура

3.1. Компоненты интерфейса

python

Копировать

Root Window          # Основное окно приложения

├── Text Widget      # Область редактирования текста

├── Save Button      # Кнопка сохранения

├── Font Menu        # Выпадающее меню выбора шрифта

└── Theme Toggle     # Кнопка переключения темной/светлой темы

3.2. Логика приложения

Event-Driven Architecture:

Обработчики событий клавиатуры

Callback-функции для кнопок

Динамическое обновление статистики

4. Основные функции

4.1. Работа с файлами

python

Копировать

def saveas():

    # Реализация:

    # 1. Получение текста из виджета

    # 2. Диалог выбора места сохранения

    # 3. Запись в файл (кодировка UTF-8)

    # 4. Поддержка горячих клавиш Ctrl+S

4.2. Управление шрифтами

python

Копировать

class FontManager:

    # Реализация:

    # - Динамическое изменение font config

    # - Поддержка шрифтов:

    #   - Helvetica

    #   - Courier

    # - Система чекбоксов в меню

4.3. Система статистики

python

Копировать

def update_stats():

    # Алгоритм:

    # 1. Считывание текста

    # 2. Подсчет слов через split()

    # 3. Подсчет символов через len()

    # 4. Обновление заголовка окна

    # Триггер: событие KeyRelease

4.4. Поисковая система

python

Копировать

class SearchEngine:

    # Особенности:

    # - Использование text.search()

    # - Подсветка результатов (tag system)

    # - Модальное диалоговое окно

    # - Горячая клавиша Ctrl+F

4.5. Темная тема

python

Копировать

def toggle_theme():

    # Реализация:

    # - Переключение цветовых схем

    # - Обновление фона/переднего плана

    # - Сохранение состояния в глобальной переменной

    # Цветовые схемы:

    # Dark: #1e1e1e (VS Code Dark)

    # Light: Системные цвета ОС

5. Система горячих клавиш

Комбинация	Действие

Ctrl+S	Сохранение файла

Ctrl+F	Поиск текста

Ctrl+Q	Выход из приложения

6. Ограничения

Поддержка только 2 шрифтов

Отсутствие открытия файлов

Нет системы вкладок

Нет проверки орфографии

Однооконный интерфейс

7. Рекомендации по развитию

markdown

Копировать

1. **Функционал**:

   - [ ] Открытие файлов

   - [ ] Undo/Redo система

   - [ ] Поддержка кодировок

2. **Интерфейс**:

   - [ ] Панель инструментов

   - [ ] Статус бар

   - [ ] Система уведомлений

3. **Оптимизация**:

   - [ ] Кэширование поиска

   - [ ] Асинхронное сохранение

   - [ ] Рефакторинг глобальных переменных

8. Структура проекта

text_editor.py          # Главный исполняемый файл

requirements.txt        # Зависимости (пустой - используются stdlib)

README.md               # Инструкция для пользователя

9. Тестирование

Ручное тестирование основных сценариев:

Сохранение/пересохранение файла

Изменение шрифтов

Переключение темы

Проверка корректности подсчета статистики

Поиск с кириллическими символами

10. Сборка и запуск

bash

Копировать

# Требуется только Python:

python3 text_editor.py

# Альтернативные способы:

python -m PyInstaller --onefile text_editor.py  # Сборка в exe

Руководство по коду text_editor.py

Этот код реализует простой текстовый редактор с использованием библиотеки Tkinter в Python.  Разберем основные части кода:

1. Импорт библиотек:

python

Копировать

from tkinter import *

from tkinter import filedialog

from tkinter import simpledialog

tkinter: Основная библиотека для создания графического интерфейса.

filedialog:  Предоставляет диалоговые окна для работы с файлами (открытие, сохранение).

simpledialog:  Предоставляет простые диалоговые окна для ввода данных.

2. Создание основного окна:

python

Копировать

root = Tk("TextEditor")

text = Text(root)

text.grid()

root.title("Текстовый редактор на Python")

root = Tk("TextEditor"): Создает главное окно приложения.  Заголовок окна "TextEditor", указанный здесь, не будет отображаться, его нужно задать через root.title().

text = Text(root): Создает виджет текстового поля (Text) внутри главного окна. Это основная область для редактирования текста.

text.grid(): Размещает текстовое поле в окне, используя менеджер геометрии grid.

root.title("Текстовый редактор на Python"): Устанавливает заголовок окна.

3. Функция сохранения файла:

python

Копировать

def saveas():

    global text

    t = text.get("1.0", "end-1c")

    savelocation = filedialog.asksaveasfilename()

    if savelocation:

        with open(savelocation, "w+") as file1:

            file1.write(t)

button = Button(root, text="Save", command=saveas)

button.grid()

saveas():  Функция, которая вызывается при нажатии на кнопку "Save".

t = text.get("1.0", "end-1c"):  Получает текст из текстового поля. "1.0" означает первую строку, нулевой символ. "end-1c" означает конец текста, минус один символ (чтобы убрать символ новой строки в конце).

savelocation = filedialog.asksaveasfilename(): Открывает диалоговое окно "Сохранить как" и позволяет пользователю выбрать имя файла и место сохранения. Возвращает выбранный путь к файлу.

if savelocation::  Проверяет, было ли выбрано место сохранения (т.е., не нажал ли пользователь "Отмена").

with open(savelocation, "w+") as file1:: Открывает файл для записи ("w+"),  with гарантирует, что файл будет автоматически закрыт после завершения работы.

file1.write(t): Записывает текст из текстового поля в файл.

button = Button(root, text="Save", command=saveas): Создает кнопку с текстом "Save" и связывает её с функцией saveas.

button.grid(): Размещает кнопку в окне.

4. Управление шрифтами:

python

Копировать

def FontHelvetica():

    global text

    text.config(font="Helvetica")

def FontCourier():

    global text

    text.config(font="Courier")

font = Menubutton(root, text="Font")

font.grid()

font.menu = Menu(font, tearoff=0)

font["menu"] = font.menu

Helvetica = IntVar()

arial = IntVar()

times = IntVar()

Courier = IntVar()

font.menu.add_checkbutton(label="Courier", variable=Courier, command=FontCourier)

font.menu.add_checkbutton(label="Helvetica", variable=Helvetica, command=FontHelvetica)

FontHelvetica() и FontCourier(): Функции, которые меняют шрифт текстового поля.

font = Menubutton(root, text="Font"): Создает выпадающее меню с текстом "Font".

font.menu = Menu(font, tearoff=0): Создает меню, которое будет связано с кнопкой "Font". tearoff=0 убирает возможность "оторвать" меню от главного окна.

font["menu"] = font.menu:  Связывает созданное меню с кнопкой "Font".

Helvetica = IntVar(), Courier = IntVar():  Создают переменные типа IntVar, которые используются для хранения состояния чекбоксов (выбрано/не выбрано).  В данном коде эти переменные не используются для хранения состояния, а просто передаются в add_checkbutton.

font.menu.add_checkbutton(...): Добавляют пункты меню с чекбоксами для выбора шрифта.  command указывает, какая функция будет вызвана при выборе этого пункта.

5. Подсчет слов и символов:

python

Копировать

def update_stats(event=None):

    content = text.get("1.0", "end-1c")

    words = len(content.split())

    chars = len(content)

    root.title(f"Текстовый редактор на Python — Слова: {words} | Символы: {chars}")

text.bind("<KeyRelease>", update_stats)

update_stats(): Функция, которая обновляет заголовок окна, показывая статистику по количеству слов и символов.

content = text.get("1.0", "end-1c"): Получает текст из текстового поля.

words = len(content.split()): Разбивает текст на слова по пробелам и считает их количество.

chars = len(content): Считает количество символов в тексте.

root.title(...): Обновляет заголовок окна, используя f-строку для форматирования текста.

text.bind("<KeyRelease>", update_stats): Связывает событие отпускания клавиши в текстовом поле (<KeyRelease>) с функцией update_stats.  Это значит, что функция будет вызываться после каждого нажатия клавиши.

6. Поиск и подсветка слова:

python

Копировать

def search_word(event=None):

    text.tag_remove("found", "1.0", "end")

    word = simpledialog.askstring("Search", "Enter word to find:")

    if word:

        start = "1.0"

        while True:

            pos = text.search(word, start, stopindex="end")

            if not pos:

                break

            end = f"{pos}+{len(word)}c"

            text.tag_add("found", pos, end)

            start = end

        text.tag_config("found", background="yellow")

search_word(): Функция, которая ищет введенное слово в тексте и подсвечивает все его вхождения.

text.tag_remove("found", "1.0", "end"): Удаляет все предыдущие выделения с тегом "found".

word = simpledialog.askstring("Search", "Enter word to find:"): Открывает диалоговое окно для ввода слова, которое нужно найти.

if word:: Проверяет, было ли введено слово.

start = "1.0": Устанавливает начальную позицию поиска.

while True:: Начинает бесконечный цикл поиска.

pos = text.search(word, start, stopindex="end"): Ищет слово, начиная с позиции start и до конца текста. Возвращает позицию первого вхождения или пустую строку, если слово не найдено.

if not pos: break: Если слово не найдено, выходит из цикла.

end = f"{pos}+{len(word)}c": Вычисляет позицию конца найденного слова.

text.tag_add("found", pos, end): Добавляет тег "found" к найденному слову.

start = end: Устанавливает новую начальную позицию для поиска (после найденного слова).

text.tag_config("found", background="yellow"): Задает стиль для тега "found" (желтый фон).

7. Выход по Ctrl+Q:

python

Копировать

def quit_editor(event=None):

    root.quit()

quit_editor(): Функция, которая закрывает приложение.

root.quit(): Завершает главный цикл Tkinter и закрывает окно.

8. Переключение темы:

python

Копировать

is_dark_mode = False

def toggle_theme():

    global is_dark_mode

    if not is_dark_mode:

        text.config(bg="#1e1e1e", fg="#dcdcdc", insertbackground="#ffffff")

        root.config(bg="#1e1e1e")

    else:

        text.config(bg="white", fg="black", insertbackground="black")

        root.config(bg="SystemButtonFace")

    is_dark_mode = not is_dark_mode

theme_button = Button(root, text="Сменить тему", command=toggle_theme)

theme_button.grid()

is_dark_mode = False:  Глобальная переменная, которая хранит текущее состояние темы (светлая или темная).

toggle_theme(): Функция, которая переключает тему.

if not is_dark_mode::  Если текущая тема светлая, переключает на темную.

text.config(bg="#1e1e1e", fg="#dcdcdc", insertbackground="#ffffff"):  Устанавливает фон, цвет текста и цвет курсора для текстового поля в темные цвета.

root.config(bg="#1e1e1e"):  Устанавливает фон главного окна в темный цвет.

else::  Иначе (если текущая тема темная), переключает на светлую.

text.config(bg="white", fg="black", insertbackground="black"): Устанавливает фон, цвет текста и цвет курсора для текстового поля в светлые цвета.

root.config(bg="SystemButtonFace"): Устанавливает фон главного окна в системный цвет.

is_dark_mode = not is_dark_mode: Инвертирует значение переменной is_dark_mode.

theme_button = Button(...): Создает кнопку для переключения темы.

9. Сохранение по Ctrl+S:

python

Копировать

def manual_save(event=None):

    t = text.get("1.0", "end-1c")

    savelocation = filedialog.asksaveasfilename()

    if savelocation:

        with open(savelocation, "w+", encoding="utf-8") as file1:

            file1.write(t)

root.bind("<Control-s>", manual_save)

manual_save():  Функция сохранения файла, аналогична saveas(), но в этот раз указывается кодировка UTF-8 при открытии файла.

root.bind("<Control-s>", manual_save): Связывает комбинацию клавиш Ctrl+S с функцией manual_save.

10. Привязка горячих клавиш и запуск главного цикла:

python

Копировать

root.bind("<Control-f>", search_word)

root.bind("<Control-q>", quit_editor)

root.mainloop()

root.bind("<Control-f>", search_word): Связывает комбинацию клавиш Ctrl+F с функцией search_word.

root.bind("<Control-q>", quit_editor): Связывает комбинацию клавиш Ctrl+Q с функцией quit_editor.

root.mainloop(): Запускает главный цикл Tkinter, который обрабатывает события и отображает окно.

